// --- Variables Globales de Diseño ---
$color-fondo: #f0e8d8;
$color-titulo: #5d4037;
$color-caption: #555;
$color-blanco: #fff;
$color-negro-transparente: rgba(0, 0, 0, 0.85);
$color-sombra-fuerte: rgba(0, 0, 0, 0.4);
$color-sombra-suave: rgba(0, 0, 0, 0.3);
$color-sombra-interna: rgba(0, 0, 0, 0.2);
$color-sombra-lightbox: rgba(255, 255, 255, 0.2);

$gradiente-madera: linear-gradient(to bottom, #8c5a3e, #6b4a32);
$borde-estante: #5d4037;
$borde-portafotos: #d3c4a8;

$fuente-principal: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
$radio-borde-sm: 4px;
$radio-borde-md: 8px;
$transicion-rapida: 0.3s ease;
$transicion-media: 0.4s ease;


// --- Estilos Generales y Reseteo Básico ---
*, *::before, *::after {
    box-sizing: border-box;
}

html {
    scroll-behavior: smooth;
}

body {
    font-family: $fuente-principal;
    background-color: $color-fondo;
    color: $color-caption;
    margin: 0;
    padding: 2.5rem 1.25rem;
    display: flex;
    flex-direction: column;
    align-items: center;
    min-height: 100vh;
}

h1 {
    color: $color-titulo;
    background-color: $color-blanco;
    padding: 0.75rem 1.5rem;
    border-radius: $radio-borde-md;
    box-shadow: 0 4px 10px $color-sombra-suave;
    text-align: center;
    border: 2px solid $borde-portafotos;
    display: inline-block; // Hacemos que la caja no ocupe todo el ancho
}

// --- Estructura de la Galería ---
.estanteria-fotos {
    width: 90%;
    max-width: 1200px;
    margin-top: -4rem; // Lo acercamos un poco más
    perspective: 800px;
}

.estante {
    background: $gradiente-madera;
    border-radius: $radio-borde-md;
    padding: 1.25rem;
    box-shadow: 0 10px 20px $color-sombra-fuerte, 0 2px 6px $color-sombra-suave;
    display: flex;
    justify-content: center;
    align-items: flex-end;
    gap: 2rem;
    flex-wrap: wrap;
    transform: rotateX(10deg);
    border-bottom: 1rem solid $borde-estante;
}

// --- Portafotos Individual ---
.portafotos {
    background-color: $color-blanco;
    border: 1rem solid $borde-portafotos;
    box-shadow: 0 5px 15px $color-sombra-suave, inset 0 0 5px $color-sombra-interna;
    padding: 0.75rem;
    border-radius: $radio-borde-sm;
    width: 180px;
    text-align: center;
    transition: transform $transicion-rapida, box-shadow $transicion-rapida;
    cursor: pointer;

    // --- Animación de entrada ---
    opacity: 0; // Inicialmente oculto
    transform: translateY(20px); // Posición inicial ligeramente abajo
    animation: fadeIn 0.6s ease-out forwards; // Aplicamos la animación

    &:hover {
        // Combinamos el transform original con el nuevo para no perder la rotación
        transform: translateY(-10px) scale(1.05) rotate(var(--rotate, 0deg));
        box-shadow: 0 15px 25px $color-sombra-fuerte, inset 0 0 5px $color-sombra-interna;
        z-index: 10;
    }

    // Rotación ligera para dar un toque más natural usando variables CSS
    &:nth-child(1) { --rotate: -2deg; transform: rotate(var(--rotate)); }
    &:nth-child(2) { --rotate: 1deg; transform: rotate(var(--rotate)); }
    &:nth-child(3) { --rotate: -1.5deg; transform: rotate(var(--rotate)); }
    &:nth-child(4) { --rotate: 2.5deg; transform: rotate(var(--rotate)); }
    &:nth-child(5) { --rotate: -1deg; transform: rotate(var(--rotate)); }

    img {
        width: 100%;
        height: auto;
        display: block;
        border: 1px solid #eee;
    }

    .caption {
        font-size: 0.875rem; // 14px
        color: $color-caption;
        margin-top: 0.5rem; // 8px
        font-style: italic;
    }
}

// --- Keyframes para la animación de entrada ---
@keyframes fadeIn {
    to {
        opacity: 1;
        // La rotación se mantiene gracias a la variable CSS
        transform: translateY(0) rotate(var(--rotate, 0deg));
    }
}

// --- Lightbox (Vista Ampliada) ---
.lightbox-overlay {
    position: fixed;
    inset: 0; // Equivalente a top, right, bottom, left = 0
    background-color: $color-negro-transparente;
    display: flex;
    justify-content: center;
    align-items: center;
    flex-direction: column;
    z-index: 1000;
    opacity: 0;
    visibility: hidden;
    transition: opacity $transicion-media, visibility $transicion-media;
    padding: 1rem;
    position: fixed; // Hacemos que los botones de navegación se posicionen relativos a este contenedor

    &.visible {
        opacity: 1;
        visibility: visible;
    }

    img {
        max-width: 85vw; // Dejamos espacio para los botones de navegación
        max-height: 80vh;
        box-shadow: 0 0 30px $color-sombra-lightbox;
        border-radius: $radio-borde-sm;
        transition: opacity $transicion-rapida; // Transición para el efecto de fade
    }
}

// Nuevo contenedor para la imagen y el botón de volver
.lightbox-content {
    display: flex;
    flex-direction: column;
    align-items: center;
}

// Contenedor para los botones de acción del lightbox
.lightbox-actions {
    display: flex;
    gap: 1rem;
    // El margen superior ahora lo da el contador
}

// Clase genérica para los botones de acción (Volver, Descargar)
.btn-lightbox {
    display: inline-block; // Para que el <a> se comporte como botón
    padding: 0.75rem 1.5rem;
    background-color: $color-blanco;
    color: #333;
    border: none;
    border-radius: $radio-borde-sm;
    font-size: 1rem;
    font-family: $fuente-principal;
    text-decoration: none;
    cursor: pointer;
    transition: background-color $transicion-rapida;

    &:hover {
        background-color: #ddd;
    }
}

// Estilos para el título de la foto en el Lightbox
.lightbox-caption {
    color: $color-blanco;
    margin-top: 0.75rem;
    margin-bottom: 0.5rem;
    font-style: italic;
    max-width: 80vw;
    text-align: center;
}

// Estilos para el contador de fotos
.lightbox-counter {
    color: #ccc; // Un color más sutil
    font-size: 0.9rem;
    margin-bottom: 1rem; // Espacio antes de los botones de acción
}

// Estilos para los botones de navegación del Lightbox
.btn-nav {
    position: absolute;
    top: 50%;
    transform: translateY(-50%);
    background-color: $color-sombra-interna;
    color: $color-blanco;
    border: none;
    border-radius: 50%;
    width: 45px;
    height: 45px;
    font-size: 1.5rem;
    font-weight: bold;
    cursor: pointer;
    transition: background-color $transicion-rapida;
    display: flex;
    justify-content: center;
    align-items: center;
    z-index: 1001; // Aseguramos que estén por encima de la imagen

    &:hover {
        background-color: $color-sombra-suave;
    }

    &.btn-anterior { left: 1rem; }
    &.btn-siguiente { right: 1rem; }
}

// --- Media Queries para Diseño Responsivo ---

// Para tablets y móviles grandes (hasta 768px)
@media (max-width: 768px) {
    body {
        padding: 1.5rem 1rem;
    }

    h1 {
        display: block; // Ocupa el ancho disponible
        width: 95%;
        font-size: 1.5rem;
    }

    .estanteria-fotos {
        width: 100%;
        margin-top: 2rem;
        perspective: none; // Desactivamos el efecto 3D en móvil
    }

    .estante {
        transform: none; // Quitamos la rotación del estante
        padding: 1rem;
        gap: 1rem;
        border-bottom-width: 0.75rem;
    }

    .portafotos {
        // Calculamos el ancho para que quepan 2 por fila, considerando el gap
        width: calc(50% - 0.5rem);
        border-width: 0.75rem;
        padding: 0.5rem;

        // Reseteamos las rotaciones individuales en móvil
        &:nth-child(n) {
            --rotate: 0deg;
            transform: none;
        }

        &:hover {
            transform: translateY(-5px) scale(1.03); // Efecto hover más sutil
        }
    }

    .lightbox-overlay img {
        max-width: 80vw; // Un poco más de espacio en móviles
    }

    .btn-nav {
        width: 40px;
        height: 40px;
        font-size: 1.2rem;
    }
}
